<!DOCTYPE html>

<html>

<head>
    <meta charset="UTF-8">
    <title>打字機3.0</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <div id="race1">

    </div>

    <div id="race2">

    </div>

    <div id="race3">

    </div>

    <div id="race4">

    </div>

    <div id="race5">

    </div>

    <div id="race6">

    </div>
</body>

<script>
    var CODE = "QWERTYUIOPASDFGHJKLZXCVBNM";
    var codeArray = [];
    var game_id = null;

    function createCode() {
        var index = [parseInt(Math.random() * 26)];
        return CODE.charAt(index);
    };

    function createLabel(code) {
        var label = document.createElement("label");
        label.className = "label";
        label.style.top = "50px";
        label.innerHTML = code;
        label.code = code;

        var html = document.documentElement;

        var labelY = parseInt(html.clientHeight);

        label.style.top = labelY + "px";

        return label;
    }

    window.onload = function () {
        document.getElementById("startBtn").disabled = false;

        document.documentElement.onkeydown = function (event) {
            var keyCode = event.keyCode; //獲取鍵盤的字符
            var code = String.fromCharCode(keyCode); //轉成大寫
            var label = codeArray[0];
            if (label.code == code) {
                clearInterval(label.interval_id);
                label.parentNode.removeChild(label);
                codeArray.splice(0, 1);
            }
        }
    }

    document.addEventListener('keydown', recordTime);
    function recordTime() {
        var time = new Date();
        var theTime = time.getTime() / 100;
        timeArray.push(theTime);

        if (timeArray.length > 1) {
            var pos = timeArray.length - 1;
            var diff = (timeArray[pos] - timeArray[pos - 1]) / 1;
            if (diff >= 1) {
                addchar(diff);
            }
        }
    }

    function addchar(diff) {
        var r = Math.random() * 2.5;
        for (var i = 0; i < r; i++) {
            var code = createCode();
            var label = createLabel(code);
            document.body.insertAdjacentElement("afterend", label);
            codeArray.push(label);
        }
    }
</script>

</html>